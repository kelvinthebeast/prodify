extends ../../layouts/default.pug
include ../../mixins/filter-status.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug
include ../../mixins/form-change-multi.pug
include ../../mixins/alert.pug

block main
  +alert-success(5500)

  h1.mb-4.text-primary Product List Page

  // Filter & Search Section
  .card.mb-4
    .card-header.d-flex.justify-content-between.align-items-center
      span Filter and Find
      a.btn.btn-success.btn-sm(href=`${prefixAdmin}/products/create`) + Add New

    .card-body
      .row.g-3
        .col-md-6
          .d-flex.flex-wrap.gap-2
            +filter-status(filterStatus)
        .col-md-6
          +search(keyword)

  // Product List Section
  .card
    .card-header.d-flex.justify-content-between.align-items-center
      span Product List
      small.text-muted Total: #{pagination.totalItems} products

    .card-body
      +form-change-multi(`${prefixAdmin}/products/change-multi?_method=PATCH`)

      table.table.table-striped.table-hover.align-middle.text-center
        thead
          tr
            th
              input(type="checkbox", name="checkall")
            th No.
            th Image
            th Product's Name
            th Price
            th Position
            th Status
            th Actions
        tbody
          each item, index in products
            tr
              td
                input(type="checkbox", name="id", value=item.id)
              td #{index + 1}
              td
                img(src=item.thumbnail || '/images/default-thumbnail.jpg', alt="Thumbnail", style="width:80px; height:auto; border-radius:6px;")
              td.text-start #{item.title}
              td #{item.price} $
              td
                input.form-control.form-control-sm.text-center(
                  type="number",
                  name="position",
                  value=item.position,
                  style="width:80px; display:inline-block;"
                )
              td
                if item.status == 'active'
                  a.badge.bg-success.text-decoration-none(
                    href="javascript:;"
                    data-id=item.id
                    data-status=item.status
                    button-change-status
                  ) Active
                else
                  a.badge.bg-warning.text-dark.text-decoration-none(
                    href="javascript:;"
                    data-id=item.id
                    data-status=item.status
                    button-change-status
                  ) Inactive
              td
                a.btn.btn-info.btn-sm.text-white.me-1(href=`/admin/products/detail/${item.id}`) Detail
                a.btn.btn-warning.btn-sm.text-white.me-1(href=`/admin/products/edit/${item.id}`) Edit
                button.btn.btn-danger.btn-sm(
                  type="button",
                  button-delete,
                  data-id=item.id
                ) Delete

      // Pagination
      +pagination(pagination)

  // Hidden forms
  form(
    id="form-change-status",
    method="POST",
    data-path=`${prefixAdmin}/products/change-status`
  )
  form(
    id="form-delete-product",
    method="POST",
    data-path=`${prefixAdmin}/products/delete`
  )

  // Scripts
  script(src="/admin/js/product.js")
  script(src="/admin/js/script.js")
